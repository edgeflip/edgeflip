{% extends "targetadmin/page.html" %}
{% block title %}{{ client.name }}{% endblock %}

{% block require %}
    /* load modules */
    require(
        [
          'app',
          'views/sidebar',
          'views/clientCampaigns',
          'views/insightsWidgets',
          'views/help'
        ], function(app, Sidebar, ClientCampaigns, InsightsWidgets, Help) {

        /* instantiate help and campaign list
           note campaign list passed json list
           of campaigns
        */ 
        var contentContainer = $("#content-container"),
            clientCampaignsContent =        
                new ClientCampaigns( {
                    parentEl: contentContainer,
                    campaigns: {{ campaigns|safe }},
                    createCampaignURL: "{% url 'targetadmin:campaign-wizard' client.pk %}",
                    campaignSummaryURL: "{% url 'targetadmin:campaign-summary' client.pk 0 %}"
                } ).$el;
            helpContent =
                new Help( {
                    parentEl: contentContainer,
                    templateOptions: {
                        howItWorksSrc: "{{ STATIC_URL }}img/how-it-works.jpg"
                    }
                } ).$el.hide(),
            insightsContent =
                new InsightsWidgets( {
                    parentEl: contentContainer
                } ).$el;


        /* instantiate sidebar, pass it help and campaign list, among other things */
        new Sidebar( {
            parentEl: contentContainer,
            model: new Backbone.Model( { state: 'campaigns' } ),
            content: {
                campaigns: clientCampaignsContent,
                widgets: insightsContent,
                help: helpContent
            },
            templateOptions: {
                logoSrc: "{{ STATIC_URL }}img/edgeflip-logo.png",
                clientName: "{{ client.name }}",
            },
            reportingDashboardURL: "{% url 'reporting:main' %}"
        } );

    } );
{% endblock %}
