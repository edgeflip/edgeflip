{% extends "targetadmin/base.html" %}
{% block title %}Campaign Wizard Final Step{% endblock %}
{% block content %}
    <h2>Confirm Campaign</h2>
    <div id="sortable">
    {% for camp in campaigns %}
        <div class="row" id="setname_{{ camp.pk }}" class="campaign-box">
            <div class="span5 well">
                <h4>{{ camp.campaign.name }}</h4> 
                <p>Filtering Criteria:</p>
                <ul>
                    {% for csf in camp.campaign.choice_set.choice_set.choicesetfilters.all %}
                        {% for ff in csf.filter.filterfeatures.all %}
                            <li>{{ ff.feature_type.name }} {{ ff.operator }} {{ ff.value }}</li>
                        {% empty %}
                            <li>No Filtering</li>
                        {% endfor %}
                    {% endfor %}
                </ul>
                <p><button id="remove-{{ camp.pk }}" class="btn btn-danger remove-campaign" data-campaign="{{ camp.pk }}">Remove</button></p>
            </div>
        </div>
    {% endfor %}
        <div id="buttons" style="padding-bottom: 40px;">
            <button id="submit-campaigns" class="btn btn-primary">Submit</button> <button id="undo" class="btn">Undo Deletion(s)</button>
        </div>
    </div>
{% endblock %}
{% block extrascript %}
<script>
    // Drag and Drop
    removed_campaigns = [];
    $(function() {
        $( "#sortable" ).sortable();
        $( "#sortable" ).disableSelection();
        $('#sortable').on("sortupdate", function(event, ui) {
            console.log(event);
            console.log(ui);
        });
    });
    $('.remove-campaign').click(function(e){
        var campaign = '#setname_' + $('#' + e.target.id).data('campaign');
        $(campaign).hide()
        removed_campaigns.push(campaign);
    });
    $('#undo').click(function(e){
        var campaign = removed_campaigns.pop();
        $(campaign).show();
    });
</script>
{% endblock %}
