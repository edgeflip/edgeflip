
<SCRIPT>

	var nextidx = {{ face_friends | length }};
	var friends = [
		{% for friend in all_friends %}
			{'id': {{friend.id}}, 'fname': '{{friend.fname}}', 'lname': '{{friend.lname}}' },
		{% endfor %}
		];

  	// This needs to the dictionary of all names, not just those initially shown...
    var fbnames = {

    	{% for friend in all_friends %}
    		{{friend.id}}: '{{friend.name}}',
    	{% endfor %}

                  };

</SCRIPT>

<form>
<table align=center border=0 cellpadding=0 class="friends_table">
	<tr>
	{% for face_friend in face_friends %}

		<td>
			<div class="friend_box" id="friend-{{face_friend.id}}">
				<div class="xout" onClick="doReplace({{face_friend.id}});">
					x
				</div>
				<div class="friend_pic">
					<img src="http://graph.facebook.com/{{face_friend.id}}/picture" border=0 />
				</div>
				<div class="friend_txt">
					<div class="friend_name dojoxEllipsis">
						{{face_friend.fname}}
					</div>
					<div class="friend_name dojoxEllipsis">
						{{face_friend.lname}}
					</div>
					<div class="friend_checkbox">
						<input type="checkbox" id="box-{{face_friend.id}}" checked="checked" onChange="toggleFriend({{face_friend.id}});">
					</div>
				</div>
			</div>
		</td>

		{% if (loop.index0 == 2) and (numFriends > 3) %}
				</tr><tr>

				{% if (numFriends == 4) %}
					<td></td>
				{% endif %}

		{% endif %}

	{% endfor %}

	</tr>
</table>

<BR />
<BR />
<div class="msg_title">Choose A Message:</div>
<div class="msg_picker">

	<div style="padding-bottom: 15px;">
		<div style="display: inline-block; padding-right: 5px; vertical-align: top;">
			<input type="radio" name="msg" value="hi-there" onChange="updateMsg();" /> 
		</div>
		<div style="display: inline-block; width: 550px;">
			Hi there <span class="preset_names"></span> -- I just donated to Chicago Public Radio and you should, too!
		</div>
	</div>

	<div style="padding-bottom: 15px;">
		<div style="display: inline-block; padding-right: 5px; vertical-align: top;">
			<input type="radio" name="msg" value="kasell" onChange="updateMsg();" /> 
		</div>
		<div style="display: inline-block; width: 550px;">
			Carl Kasell has a message for you. Go donate to Chicago Public Radio, <span class="preset_names"></span>!
		</div>
	</div>

	<div style="padding-bottom: 15px;">
		<div style="display: inline-block; padding-right: 5px; vertical-align: top;">
			<input type="radio" name="msg" value="other" onChange="updateMsg();" /> 
		</div>
		<div style="display: inline-block; width: 550px;">
			Write your own message (type around your friends' names):<BR />
			<div id="other_msg" style="display: none; border: solid thin gray; padding: 10px; width: 500px;" contentEditable="True">Replace this text with your message for </div>
		</div>
	</div>	

</div>

<BR>
<CENTER>
<div id="do_share_button" onmouseover="button_change('do_share_button', '{{ url_for('static', filename='share_mouse.jpg') }}');" onmouseout="button_change('do_share_button', '{{ url_for('static', filename='share.jpg') }}');" onclick="postContrib();"></div>
</CENTER>

</form>

<script>

	// Quick code to pre-load messages for testing...
	
    {% for face_friend in face_friends %}
    	recips.push({{face_friend.id}});
    {% endfor %}

    {% for face_friend in face_friends %}
		$('#other_msg').append(' <span class="msg_friend_name msg-txt-friend" id="msg-txt-friend-'+{{face_friend.id}}+'" contentEditable="False">'+fbnames[{{face_friend.id}}]+'</span> ');
    {% endfor %}

	$('.preset_names').html(friendNames());

</script>

