<div id="filtering" class="wizard-step" style="display: none;">
    <div class="row">
        <div class="span12">
            <div class="row targeting-header">
                <div class="span12 header-container">
                    <h2 class="wizard-header">Select a target audience</h2>
                    <p>
                        Define a Target Audience for your campaign by dragging one or more filters from the Available Filters container to the Enabled Filters container.
                    </p>
                    <p>
                        To create a new filter, just click "Add Filter," select the filter type and filtering criteria, and click "Save changes."
                    </p>
                    <p>
                        <span>You can also add up to four Fallback Audiences with fewer filters enabled.</span>
                        <button data-js="learnMoreBtn" type="button" class="btn btn-link">Learn more</button>
                    </p>
                </div>
                
            </div>

            <div data-js="enabledFiltersContainer" id="enabled-section" class="row">
                <h3 class="span12">Enabled Filters</h3>
                <h6 class="span12">
                    <span>Target Audience</span>
                    <button type="button" data-js="addLayerBtn" class="btn btn-mini add-fallback-btn" data-layer-count="1">Add Fallback Audience</button>
                </h6>
                <div class="span12">
                    <input type="hidden" id="id_enabled-filters-1" name="enabled-filters-1">
                    <div data-js="enabledFilters" class="clearfix well sortable target-well filter-well" id="enabled-filters-1"></div>
                </div>
            </div>
            <div id="available-section" class="row">
                <h3 class="span12">
                    <span>Available Filters</span>
                    <button type="button"
                            data-target="#filter-modal"
                            href="{% url 'targetadmin:filter-add' client.pk %}"
                            id="create-filter-btn"
                            class="btn btn-mini add-filter-btn"
                            data-toggle="modal">Add Filter</button>
                </h3>
                <div data-js="existingFilters" class="span12 well sortable target-well filter-well" id="existing-filters"></div>
            </div>
            <div class="row empty-fallback">
                <div class="span12">
                    {{ campaign_form.include_empty_fallback.errors }}
                    <label for="{{ campaign_form.include_empty_fallback.id_for_label }}">{{ campaign_form.include_empty_fallback.label }}:</label>
                    {{ campaign_form.include_empty_fallback }}
                    <i data-js="emptyFallbackHelpIcon" class="icon-question-sign empty-fallback-question" data-placement="right" data-content=""></i>
                </div>
            </div>
           
            <div class="row wizard-button-container">
                <button type="button" id="step2-prev" class="btn btn-link step-submit filter-step pull-left" data-step="intro">Previous</button>
                <button type="button" id="step2-next" class="btn btn-large btn-primary step-submit filter-step" data-step="faces">Next</button>
            </div>
        </div>
    </div>
    <div id="filter-modal" class="modal hide fade" tabindex="-1" role="dialog">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="filter-modal-label">Create Filter</h3>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button id="filter-add" class="btn btn-primary">Save changes</button>
        </div>
    </div>
    <div id="target-audience-help-modal" class="modal hide fade" tabindex="-1" role="dialog">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="filter-modal-label">Targeted Sharing Audience</h3>
        </div>
        <div class="modal-body filter-help">
            <p>
                <i class="begin">Target Audience : </i> When your supporters share your campaign with their Facebook friends, we will present
                them with a list of friend suggestions based on the target audience you define using a set of filters. You can
                enable multiple filters; your target audience will consist of friends who meet all of these criteria.
                For example, if your target audience is <i>24 - 30 year-old men living in North Carolina</i>, then you would
                enable three filters -- 'Males', 'Between 24 and 30', and 'Lives in North Carolina.'
            </p>
            <p>
                <i class="begin">Fallback Audiences : </i> Some of your supporters may not have any friends in your Target Audience.
                For this reason, we recommend adding one or more Fallback Audiences with fewer (or less restrictive)
                filters enabled. For example, if your Target Audience is <i>24 - 30 year-old men living in North Carolina</i>,
                your first Fallback Audience might expand the age filter: <i>18 - 50 year-old men living in North Carolina</i>.
                You might also select a second Fallback Audience with an expanded location filter: <i>24 - 30 year-old men
                living in North Carolina, South Carolina, and Virginia</i>. A third Fallback Audience might simply target <i>men</i>.
                To add a Fallback Audience, just click "Add Fallback Audience." 
            </p>
            <p data-js="emptyFallbackHelpText">
                <i class="begin">Empty Fallback : </i> 
            </p>
            <p>
                <i class="begin">More questions?</i> Please <a href="mailto:help@edgeflip.com" target="_blank">contact us</a> and we'll be happy to walk you through it.
            </p>
        </div>
    </div>
</div>
<script src="{{ STATIC_URL }}js/campaignWizardFilter.js"></script>
<script src="{{ STATIC_URL }}js/filterModels.js"></script>
<script src="{{ STATIC_URL }}js/filterCollection.js"></script>
<script type="text/javascript">
    window.campaignWizardFilterView = new window.campaignWizardFilterView( {
        el: '#filtering',
        filters: new filterCollection( {{ filter_features|safe }} )
    } );
</script>
